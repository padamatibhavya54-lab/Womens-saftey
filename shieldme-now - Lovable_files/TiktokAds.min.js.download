var TiktokAds_RS=function(t){"use strict";const e=[{destKey:"event_id",sourceKeys:["properties.eventId","properties.event_id","messageId"]},{destKey:"test_event_code",sourceKeys:"testEventCode"},{destKey:"contents",sourceKeys:"properties.contents"},{destKey:"content_category",sourceKeys:"properties.category"},{destKey:"status",sourceKeys:"properties.status"},{destKey:"content_name",sourceKeys:"properties.name"},{destKey:"content_id",sourceKeys:["properties.product_id","properties.productId"]},{destKey:"content_type",sourceKeys:["properties.contentType","properties.content_type"]},{destKey:"currency",sourceKeys:"properties.currency"},{destKey:"value",sourceKeys:"properties.value"},{destKey:"description",sourceKeys:"properties.description"},{destKey:"email",sourceKeys:["context.traits.email","traits.email","properties.email"]},{destKey:"phone",sourceKeys:["context.traits.phone","traits.phone","properties.phone"]}],n={"product added to wishlist":"AddToWishlist","product added":"AddToCart","checkout started":"InitiateCheckout","payment info entered":"AddPaymentInfo","checkout step completed":"CompletePayment","order completed":"PlaceAnOrder",viewcontent:"ViewContent",clickbutton:"ClickButton",search:"Search",contact:"Contact",download:"Download",submitform:"SubmitForm",completeregistration:"CompleteRegistration",subscribe:"Subscribe",purchase:"Purchase",lead:"Lead",customizeproduct:"CustomizeProduct",findlocation:"FindLocation",schedule:"Schedule"},r={LOG:{value:0,method:console.log},INFO:{value:1,method:console.info},DEBUG:{value:2,method:console.debug},WARN:{value:3,method:console.warn},ERROR:{value:4,method:console.error}};class o{constructor(t,e){this.level=+e||r.ERROR.value,this.scope=t||""}setLogLevel(t){if(t&&"string"==typeof t){const e=t.toUpperCase();this.level=r[e]?r[e].value:this.level}}setScope(t){this.scope=t||this.scope}log(...t){this.logBase(t,r.LOG.value)}info(...t){this.logBase(t,r.INFO.value)}debug(...t){this.logBase(t,r.DEBUG.value)}warn(...t){this.logBase(t,r.WARN.value)}error(...t){this.logBase(t,r.ERROR.value)}logBase(t,e){if(this.level<=e){Object.values(r).find(t=>t.value===e).method(...this.getLogData(t))}}getLogData(t){if(Array.isArray(t)&&t.length>0){let e="%c RS SDK";this.scope&&(e=`${e} - ${this.scope}`);e=`${e} %c ${t[0].trim()}`;const n=[];return n.push(e),n.push("font-weight: bold; background: black; color: white;"),n.push("font-weight: normal;"),n.push(...t.slice(1)),n}return t}}function s(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function i(t){return function e(n){return 0===arguments.length||s(n)?e:t.apply(this,arguments)}}function a(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return s(n)?e:i(function(e){return t(n,e)});default:return s(n)&&s(r)?e:s(n)?i(function(e){return t(e,r)}):s(r)?i(function(e){return t(n,e)}):t(n,r)}}}const c=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)};function u(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function l(t,e,n){for(var r=0,o=n.length;r<o;){if(t(e,n[r]))return!0;r+=1}return!1}function f(t,e){return Object.prototype.hasOwnProperty.call(e,t)}const p="function"==typeof Object.is?Object.is:function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e};var d=Object.prototype.toString,y=function(){return"[object Arguments]"===d.call(arguments)?function(t){return"[object Arguments]"===d.call(t)}:function(t){return f("callee",t)}}(),g=!{toString:null}.propertyIsEnumerable("toString"),m=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],h=function(){return arguments.propertyIsEnumerable("length")}(),v=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},b="function"!=typeof Object.keys||h?i(function(t){if(Object(t)!==t)return[];var e,n,r=[],o=h&&y(t);for(e in t)!f(e,t)||o&&"length"===e||(r[r.length]=e);if(g)for(n=m.length-1;n>=0;)f(e=m[n],t)&&!v(r,e)&&(r[r.length]=e),n-=1;return r}):i(function(t){return Object(t)!==t?[]:Object.keys(t)}),A=i(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function j(t,e,n,r){var o=u(t);function s(t,e){return O(t,e,n.slice(),r.slice())}return!l(function(t,e){return!l(s,e,t)},u(e),o)}function O(t,e,n,r){if(p(t,e))return!0;var o,s,i=A(t);if(i!==A(e))return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof e["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e)&&"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof e.equals)return"function"==typeof t.equals&&t.equals(e)&&"function"==typeof e.equals&&e.equals(t);switch(i){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===(o=t.constructor,null==(s=String(o).match(/^function (\w*)/))?"":s[1]))return t===e;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof e||!p(t.valueOf(),e.valueOf()))return!1;break;case"Date":if(!p(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(t.source!==e.source||t.global!==e.global||t.ignoreCase!==e.ignoreCase||t.multiline!==e.multiline||t.sticky!==e.sticky||t.unicode!==e.unicode)return!1}for(var a=n.length-1;a>=0;){if(n[a]===t)return r[a]===e;a-=1}switch(i){case"Map":return t.size===e.size&&j(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size===e.size&&j(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var c=b(t);if(c.length!==b(e).length)return!1;var u=n.concat([t]),l=r.concat([e]);for(a=c.length-1;a>=0;){var d=c[a];if(!f(d,e)||!O(e[d],t[d],u,l))return!1;a-=1}return!0}var S=a(function(t,e){return O(t,e,[],[])});var w=i(function(t){return null!=t&&"function"==typeof t["fantasy-land/empty"]?t["fantasy-land/empty"]():null!=t&&null!=t.constructor&&"function"==typeof t.constructor["fantasy-land/empty"]?t.constructor["fantasy-land/empty"]():null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():t==Set||t instanceof Set?new Set:t==Map||t instanceof Map?new Map:c(t)?[]:function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)?"":function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)?{}:y(t)?function(){return arguments}():function(t){var e=Object.prototype.toString.call(t);return"[object Uint8ClampedArray]"===e||"[object Int8Array]"===e||"[object Uint8Array]"===e||"[object Int16Array]"===e||"[object Uint16Array]"===e||"[object Int32Array]"===e||"[object Uint32Array]"===e||"[object Float32Array]"===e||"[object Float64Array]"===e||"[object BigInt64Array]"===e||"[object BigUint64Array]"===e}(t)?t.constructor.from(""):void 0}),k=i(function(t){return null!=t&&S(t,w(t))}),_=a(function(t,e){var n={};for(var r in e)t(e[r],r,e)&&(n[r]=e[r]);return n});const K=t=>!(t=>void 0===t)(t),E=t=>K(t)&&(t=>null!=t)(t),C=t=>_(E,t),I=(t,e="from",n="to",r=!0)=>{const o={};return Array.isArray(t)&&t.forEach(t=>{if(s=t[e],k(s))return;var s;if("string"!=typeof t[e])return;const i=r?t[e].toLowerCase().trim():t[e].trim();if(o[i]){o[i].includes(t[n])||o[i].push(t[n])}else o[i]=[t[n]]}),o};for(var q=Object.defineProperty,T=(t,e)=>q(t,"name",{value:e,configurable:!0}),L=T(t=>null!==t&&"object"==typeof t,"isObject"),R=T((t,e,n)=>"function"==typeof n.join?n.join(t):t[0]+e+t[1],"join"),x=T((t,e,n)=>"function"==typeof n.split?n.split(t):t.split(e),"split"),B=T((t,e={},n)=>"function"!=typeof n?.isValid||n.isValid(t,e),"isValid"),D=T(t=>L(t)||"function"==typeof t,"isValidObject"),U=T((t,e,n={})=>{if(L(n)||(n={default:n}),!D(t))return void 0!==n.default?n.default:t;"number"==typeof e&&(e=String(e));const r=Array.isArray(e),o="string"==typeof e,s=n.separator||".",i=n.joinChar||("string"==typeof s?s:".");if(!o&&!r)return t;if(void 0!==t[e])return B(e,t,n)?t[e]:n.default;const a=r?e:x(e,s,n),c=a.length;let u=0;do{let e=a[u];for("string"!=typeof e&&(e=String(e));e&&"\\"===e.slice(-1);)e=R([e.slice(0,-1),a[++u]||""],i,n);if(void 0!==t[e]){if(!B(e,t,n))return n.default;t=t[e]}else{let r=!1,o=u+1;for(;o<c;)if(e=R([e,a[o++]],i,n),r=void 0!==t[e]){if(!B(e,t,n))return n.default;t=t[e],u=o-1;break}if(!r)return n.default}}while(++u<c&&D(t));return u===c?t:n.default},"getValue"),N=256;N--;)(N+256).toString(16).substring(1);for(var F=0;F<256;F++)(F+256).toString(16).substring(1);const P=new o("Utils"),V=t=>K(t)&&(t=>null!==t)(t),M=({message:t,operationObject:e})=>{const{operation:n,args:r}=e,o=r.map(e=>{const{sourceKeys:n,defaultVal:r}=e,o=U(t,n);return o||!1===o||0===o?o:r});if(!o.every(t=>V(t)))return null;let s=null;switch(n){case"multiplication":s=1;for(const t of o){if("number"!=typeof t)return null;s*=t}return s.toFixed(2);case"addition":s=0;for(const t of o){if("number"!=typeof t)return null;s+=t}return s.toFixed(2);default:return null}},z=(t,e)=>{let n=t;const r={jsonStringify:()=>{n=JSON.stringify(t)},jsonStringifyOnObject:()=>{"string"!=typeof t&&(n=JSON.stringify(t))},toString:()=>{n=String(t)},toNumber:()=>{n=Number(t)},toFloat:()=>{n=parseFloat(t)},toInt:()=>{n=parseInt(t,10)},toLower:()=>{n=t.toString().toLowerCase()},trim:()=>{"string"==typeof t&&(n=t.trim())},IsBoolean:()=>{n=!0,"boolean"!=typeof t&&(P.debug("Boolean value missing, so dropping it"),n=!1)}};if(e in r){(0,r[e])()}return n},$=(t,e)=>{const n={};return Array.isArray(e)&&e.length>0&&e.forEach(e=>{const{sourceKeys:r,destKey:o,metadata:s}=e,i=((t,e)=>{if(!e)return t;const{type:n,defaultValue:r}=e;if(!V(t))return r||t;let o=t;return n&&(Array.isArray(n)?n.forEach(t=>{o=z(o,t)}):o=z(o,n)),o})(((t,e)=>{if(Array.isArray(e)&&e.length>0){for(const n of e){let e;if(e="object"==typeof n?M({message:t,operationObject:n}):U(t,n),e||!1===e||0===e)return e}return null}return"object"==typeof e?M({message:t,operationObject:e}):U(t,e)})(t,r),s);(i||0===i||!1===i)&&o&&(n[o]=i)}),n},G=t=>{let e=[];const{properties:n}=t,{products:r,content_type:o,contentType:s}=n;return Array.isArray(r)&&(e=r.map(t=>{const e={content_type:t.contentType||s||t.content_type||o||"product",content_id:t.product_id,content_category:t.category,content_name:t.name,price:t.price,quantity:t.quantity,description:t.description};return C(e)})),e},J=t=>{let n=$(t,e);return n?.contents&&!Array.isArray(n.contents)&&(n.contents=[n.contents]),n&&!n?.contents&&t.properties?.products&&(n={...n,contents:G(t)}),n?.contents&&(n.contents=((t,e)=>{let n=t;return Array.isArray(t)&&(n=t.map(t=>{const n={...t};return t.content_type||(n.content_type=e||"product_group"),n})),n})(n?.contents,t.properties?.contentType)),C({...n,partner_name:"RudderStack"})};const W=new o("TikTok Ads");return t.TiktokAds=class{constructor(t,e,n){e.logLevel&&W.setLogLevel(e.logLevel),this.name="TIKTOK_ADS",this.analytics=e,this.eventsToStandard=t.eventsToStandard,this.pixelCode=t.pixelCode,this.sendCustomEvents=t.sendCustomEvents,({shouldApplyDeviceModeTransformation:this.shouldApplyDeviceModeTransformation,propagateEventsUntransformedOnError:this.propagateEventsUntransformedOnError,destinationId:this.destinationId}=n??{})}init(){var t;t=this.pixelCode,function(t,e,n){t.TiktokAnalyticsObject=n;var r=t[n]=t[n]||[];r.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],r.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var o=0;o<r.methods.length;o++)r.setAndDefer(r,r.methods[o]);r.instance=function(t){for(var e=r._i[t]||[],n=0;n<r.methods.length;n++)r.setAndDefer(e,r.methods[n]);return e},r.load=function(t,e){var o="https://analytics.tiktok.com/i18n/pixel/events.js";r._i=r._i||{},r._i[t]=[],r._i[t]._u=o,r._t=r._t||{},r._t[t]=+new Date,r._o=r._o||{},r._o[t]=e||{};var s=document.createElement("script");s.setAttribute("data-loader","RS_JS_SDK"),s.type="text/javascript",s.async=!0,s.src=o+"?sdkid="+t+"&lib="+n;var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(s,i)}}(window,document,"ttq"),ttq.load(t)}isLoaded(){return!!window.ttq}isReady(){return this.isLoaded()}identify(t){const{message:e}=t,{traits:n}=e.context,{email:r,phone:o,number:s}=n,i={};if(E(r)&&(i.email=r),(E(o)||E(s))&&(i.phone=o||s),Object.keys(i).length>0){const t=function(t,e){let n=null,r=null;return t.context?.externalId&&(n=t.context.externalId),n&&Array.isArray(n)&&n.forEach(t=>{t.type===e&&(r=t.id)}),r}(e,"tiktokExternalId");E(t)?window.ttq.identify(t,i):window.ttq.identify(i)}}track(t){const{message:e}=t;let r=e?.event;if(!r)return void W.error("Event name is required");r=r?.toLowerCase().trim();const o=I(this.eventsToStandard);if(!this.sendCustomEvents&&void 0===n[r]&&!o[r])return void W.error(`Event name (${r}) is not valid, must be mapped to one of standard events`);if(o[r])return void Object.keys(o).forEach(t=>{t===r&&o[r].forEach(t=>{const n=J(e);window.ttq.track(t,n)})});r=n[r]||e.event;const s=J(e);window.ttq.track(r,s)}page(t){window.ttq.page()}},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t}({});
//# sourceMappingURL=TiktokAds.min.js.map
