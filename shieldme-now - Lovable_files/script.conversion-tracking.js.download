(()=>{var L=Object.defineProperty,R=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var C=(a,t,o)=>t in a?L(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,y=(a,t)=>{for(var o in t||(t={}))B.call(t,o)&&C(a,o,t[o]);if(D)for(var o of D(t))$.call(t,o)&&C(a,o,t[o]);return a},b=(a,t)=>R(a,N(t));var j=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports);var S=(a,t,o)=>new Promise((A,p)=>{var w=c=>{try{d(o.next(c))}catch(u){p(u)}},l=c=>{try{d(o.throw(c))}catch(u){p(u)}},d=c=>c.done?A(c.value):Promise.resolve(c.value).then(w,l);d((o=o.apply(a,t)).next())});var H=j(O=>{(function(){var _;let a=document.currentScript,t="dub_id",o="dub_partner_data",A=90*24*60*60*1e3,p=window.location.hostname,w=a.getAttribute("data-api-host")||"https://api.dub.co",l=a.getAttribute("data-publishable-key"),d=(()=>{let i={domain:p==="localhost"?void 0:`.${p.replace(/^www\./,"")}`,path:"/",sameSite:"Lax",expires:new Date(Date.now()+A).toUTCString()},n=a.getAttribute("data-cookie-options");if(!n)return i;let e=JSON.parse(n);return e.expiresInDays&&(e.expires=new Date(Date.now()+e.expiresInDays*24*60*60*1e3).toUTCString(),delete e.expiresInDays),y(y({},i),e)})(),c=(()=>{let i=a.getAttribute("data-short-domain"),n=a.getAttribute("data-domains");if(n)try{let e=JSON.parse(n);return b(y({},e),{refer:e.refer||i})}catch(e){}return{refer:i}})(),u=c.refer,f=a.getAttribute("data-attribution-model")||"last-click",P=(()=>{let i=a.getAttribute("data-query-param"),n=a.getAttribute("data-query-params"),e=["via"];if(i)e=[i,...e];else if(n)try{e=[...JSON.parse(n),...e]}catch(s){console.warn("[dubAnalytics] Failed to parse data-query-params.",s)}return[...new Set(e)]})(),m=(()=>{let i=new URLSearchParams(location.search);for(let n of P)if(i.get(n))return i.get(n);return null})();if(window.DubAnalytics=window.DubAnalytics||{partner:null,discount:null},window.dubAnalytics){let e=function(s,...r){s==="ready"?e.ready(...r):s==="trackClick"?e.trackClick(...r):console.warn("[dubAnalytics] Unknown method:",s)};var J=e;let n=window.dubAnalytics.q||[];e.q=n,e.ready=function(s){s()},e.trackClick=function(...s){g(...s)},window.dubAnalytics=e}let k={get(i){var n;return(n=document.cookie.split(";").map(e=>e.trim().split("=")).find(([e])=>e===i))==null?void 0:n[1]},set(i,n){let e=Object.entries(d).filter(([,s])=>s).map(([s,r])=>`${s}=${r}`).join("; ");document.cookie=`${i}=${n}; ${e}`}},h={queue:((_=window.dubAnalytics)==null?void 0:_.q)||[],flush(i){let n=[];for(;this.queue.length;){let[e,...s]=this.queue.shift();!i||i(e)?this.process({method:e,args:s}):n.push([e,...s])}this.queue=n},process({method:i,args:n}){if(i==="ready"){let e=n[0];e()}else["trackClick"].includes(i)?g(...n):console.warn("[dubAnalytics] Unknown method:",i)}},I=!1;function g({domain:i,key:n}){if(I)return;I=!0;let s=new URLSearchParams(location.search).get(t);fetch(`${w}/track/click`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:i,key:n,url:window.location.href,referrer:document.referrer})}).then(r=>r.ok&&r.json()).then(r=>{if(r){if(s&&s!==r.clickId){console.warn(`[dubAnalytics] Client-tracked click ID ${r.clickId} does not match server-tracked click ID ${s}, skipping...`);return}if(k.set(t,r.clickId),r.partner){let U=b(y({},r),{partner:b(y({},r.partner),{name:encodeURIComponent(r.partner.name),image:r.partner.image?encodeURIComponent(r.partner.image):null})});k.set(o,JSON.stringify(U)),DubAnalytics.partner=r.partner,DubAnalytics.discount=r.discount,h.flush(E=>E==="ready")}return r}})}function T(){let i=new URLSearchParams(location.search),n=()=>!k.get(t)||f!=="first-click",e=i.get(t);e&&n()&&k.set(t,e),m&&u&&n()&&g({domain:u,key:m}),h.flush(r=>r==="trackClick");let s=k.get(o);if(s)try{let r=JSON.parse(s);DubAnalytics.partner=r.partner,DubAnalytics.discount=r.discount}catch(r){console.error("[dubAnalytics] Failed to parse partner cookie:",r)}}window._dubAnalytics={c:k,qm:h,i:t,h:p,a:w,d:u,v:m,n:c,k:l},T()})();var q=()=>{let{a,k:t,c:o,i:A}=window._dubAnalytics||{};if(!a){console.warn("[dubAnalytics] Missing API_HOST");return}if(!t){console.warn("[dubAnalytics] Missing PUBLISHABLE_KEY");return}let p=l=>S(O,null,function*(){let d=o==null?void 0:o.get(A),c=y({clickId:d!=null?d:""},l),u=yield fetch(`${a}/track/lead/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(c)}),f=yield u.json();return u.ok||console.error("[dubAnalytics] trackLead failed",f.error),f}),w=l=>S(O,null,function*(){let d=o==null?void 0:o.get(A),c=y({clickId:d!=null?d:""},l),u=yield fetch(`${a}/track/sale/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(c)}),f=yield u.json();return u.ok||console.error("[dubAnalytics] trackSale failed",f.error),f});if(window.dubAnalytics&&(window.dubAnalytics.trackLead=function(...l){p(...l)},window.dubAnalytics.trackSale=function(...l){w(...l)}),window._dubAnalytics&&window._dubAnalytics.qm){let l=window._dubAnalytics.qm,c=(l.queue||[]).filter(([u,...f])=>u==="trackLead"?(p(...f),!1):u==="trackSale"?(w(...f),!1):!0);l.queue=c}};window._dubAnalytics?q():window.addEventListener("load",q)});H();})();
